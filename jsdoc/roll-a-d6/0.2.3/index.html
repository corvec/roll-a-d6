<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Home</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Home</h1>

    



    


    <h3>roll-a-d6 0.2.3</h3>










    




    <section>
        <article><h1>Roll A D6</h1>
<h2>What / why?</h2>
<p><code>roll-a-d6</code> is a dice rolling engine library that supports sophisticated macros and formulas that no other dice roller supports.</p>
<p>At its core, we have the dice roller: <code>rollFormula(formula, macrosObject)</code></p>
<h3>Example:</h3>
<pre class="prettyprint source lang-javascript"><code>import * as d6 from 'roll-a-d6';

const roll = d6.rollFormula('1d20+Strength,1d8+Strength', { Strength: '5' });
console.log(roll.result.join(', '));
</code></pre>
<p>The components of the dice roller include the validator, tokenizer, parser, RPN converter, and evaluator.
For more information, check out the API docs <a href="./jsdoc/roll-a-d6/0.2.2/global.html">here</a>.</p>
<p>An example of a more sophisticated dice roll that this package supports:</p>
<pre class="prettyprint source lang-javascript"><code>import * as d6 from 'roll-a-d6';

const macros = {
  roll: 'r=1d20,(^adv&&^disadv)||(adv==0&&disadv==0)->r[0];(adv->r[0]>>r[1];r[0]&lt;&lt;r[1])',
  atk: 'roll[0]==20->dmgDice[0]+dmgDice[1]+dmgMod;(roll[0]==1->0;roll[0]+bonus>ac@Defender->dmgDice[0]+dmgMod;0)',
  bonus: 'prof+dmgMod',
  shortSword: '1d6,dmgMod=Dex>>Str',
  sneakAttack: '3d6',
  sneakAttackIfPossible: 'canYouSneakAttack->sneakAttack;0',
  Str: '10',
  Dex: '18',
  prof: '3',
};
const roll = d6.rollFormula('ac@Defender=?,canYouSneakAttack=1,dmgDice=shortSword,(atk[0]+atk[1])>0->(atk[0]+atk[1]+sneakAttackIfPossible);0', macros);
//  now I know the attacker's AC is 15
const foundResult = roll.result.find(({ minValue, maxValue }) => minValue &lt;= 15 && !(maxValue &lt; 15));
console.log(foundResult[0]);
</code></pre>
<h2>Roll Syntax</h2>
<h3>Constants</h3>
<h3>Rolls</h3>
<p>Rolls should be in the format of <em>x</em>d<em>y</em>, e.g., '1d20' or</p>
<h3>Operators</h3>
<p>Operators should be used infix, e.g., 5+7, though they are evaluated postfix.</p>
<h4>Arithmetic</h4>
<p>+, -, *, /</p>
<h4>Comparisons</h4>
<p>Greater than (<code>&gt;</code>), Less than (<code>&lt;</code>), and other similar operators (<code>&lt;=</code>, <code>&gt;=</code>, <code>==</code>, and <code>&lt;&gt;</code> (not equal))  return true or false.</p>
<p>Greater of (<code>&gt;&gt;</code>) and Lesser of (<code>&lt;&lt;</code>) return the appropriate value, e.g., <code>5&lt;&lt;7</code> returns <code>5</code>.</p>
<h4>Logic</h4>
<p><code>||</code> and <code>&amp;&amp;</code> perform the equivalent operations.</p>
<h4>Conditionals</h4>
<p><code>-&gt;</code> and  <code>;</code> are the equivalents of then and else. For example: <code>1d20&gt;10-&gt;1d6;0</code> will first roll 1d20,
then compare that value to 10. If the value is greater than 10, it will roll 1d6 and return the result
of that roll. If the value is less than or equal to 10, it will return 0.</p>
<h4>Expansion operators</h4>
<p>These operators allow you to roll the same thing many times with ease. For example, <code>4#+1d6</code> is the
equivalent of <code>1d6+1d6+1d6+1d6</code>. This is distinct from 4*1d6 because the former will not reroll those
dice; the latter will.</p>
<p>The following operators are supported:</p>
<ul>
<li><code>#+</code> - Add the results together</li>
<li><code>#*</code> - Multiply the results together</li>
<li><code>#&amp;</code> - AND (<code>&amp;&amp;</code>) the results together, returning the last value if all are truthy, or the first falsy value.</li>
<li><code>#|</code> - OR (<code>||</code>) the results together, returning the last value if all are falsy, or the first truthy value.</li>
</ul>
<h4>Default values</h4>
<p>Prefixing a variable reference with <code>^</code> will cause it to be treated as 0 if it was not passed in.</p>
<h4>Macro evaluation</h4>
<h5>Global and Local Macro Instance Evaluation</h5></article>
    </section>






</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#buildResultRange">buildResultRange</a></li><li><a href="global.html#clauseHasMislocatedAssignmentOperator">clauseHasMislocatedAssignmentOperator</a></li><li><a href="global.html#convertFormulaToRoll">convertFormulaToRoll</a></li><li><a href="global.html#convertToRPN">convertToRPN</a></li><li><a href="global.html#evaluate">evaluate</a></li><li><a href="global.html#evaluateExpression">evaluateExpression</a></li><li><a href="global.html#evaluateFormula">evaluateFormula</a></li><li><a href="global.html#getAllRolls">getAllRolls</a></li><li><a href="global.html#getInitialRollIndex">getInitialRollIndex</a></li><li><a href="global.html#getMacroIndex">getMacroIndex</a></li><li><a href="global.html#getMacroName">getMacroName</a></li><li><a href="global.html#getMacrosFromCollection">getMacrosFromCollection</a></li><li><a href="global.html#getNewVariablesReduceHelper">getNewVariablesReduceHelper</a></li><li><a href="global.html#getPropertyByPath">getPropertyByPath</a></li><li><a href="global.html#getRollMetadata">getRollMetadata</a></li><li><a href="global.html#getRollType">getRollType</a></li><li><a href="global.html#getTargetCollection">getTargetCollection</a></li><li><a href="global.html#getUnassignedVariablesAndUsedMacros">getUnassignedVariablesAndUsedMacros</a></li><li><a href="global.html#isConditional">isConditional</a></li><li><a href="global.html#isExpansionOperator">isExpansionOperator</a></li><li><a href="global.html#isGlobalMacroInstance">isGlobalMacroInstance</a></li><li><a href="global.html#isGrouping">isGrouping</a></li><li><a href="global.html#isMacroInstance">isMacroInstance</a></li><li><a href="global.html#isNumber">isNumber</a></li><li><a href="global.html#isOperator">isOperator</a></li><li><a href="global.html#isRoll">isRoll</a></li><li><a href="global.html#isSideEffectOperator">isSideEffectOperator</a></li><li><a href="global.html#isSideEffectVariable">isSideEffectVariable</a></li><li><a href="global.html#isValidToken">isValidToken</a></li><li><a href="global.html#isValue">isValue</a></li><li><a href="global.html#isVariable">isVariable</a></li><li><a href="global.html#isVariableInstance">isVariableInstance</a></li><li><a href="global.html#objectMakerReduceHelper">objectMakerReduceHelper</a></li><li><a href="global.html#op1Precedes">op1Precedes</a></li><li><a href="global.html#operatorOrder">operatorOrder</a></li><li><a href="global.html#parseAssignments">parseAssignments</a></li><li><a href="global.html#parseTokens">parseTokens</a></li><li><a href="global.html#peek">peek</a></li><li><a href="global.html#rollAD">rollAD</a></li><li><a href="global.html#rollFormula">rollFormula</a></li><li><a href="global.html#splitTokenList">splitTokenList</a></li><li><a href="global.html#stripPrefix">stripPrefix</a></li><li><a href="global.html#stripSuffix">stripSuffix</a></li><li><a href="global.html#tokenize">tokenize</a></li><li><a href="global.html#validateAlternatingTokenType">validateAlternatingTokenType</a></li><li><a href="global.html#validateBrackets">validateBrackets</a></li><li><a href="global.html#validateClause">validateClause</a></li><li><a href="global.html#validateFormula">validateFormula</a></li><li><a href="global.html#validateParentheses">validateParentheses</a></li><li><a href="global.html#variableTargetsCollection">variableTargetsCollection</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Sun Mar 15 2020 23:42:35 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>